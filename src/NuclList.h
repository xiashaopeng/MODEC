#ifndef _NUCL_LIBRARY_H
#define _NUCL_LIBRARY_H
/* 存储核素ID以及实现核素index位置获取 */

#include <sstream>
#include"ErrorMessage.h"
using namespace std;

// 存储核素信息，包括核素ID、初始核素浓度、
// 存储各核素的各类衰变信息及各类截面信息
/* 衰变信息：	 衰变常数lamda；
衰变热 Q；
放射性毒性系数 （ORIGENS的两种放射性毒性单位）
自发裂变份额FSF，用于计算自发裂变中子场
放射性毒性系数 Sv/Bq （国际标准的放射性毒性单位）*/

/* 截面信息：	 总截面 tot-cap; (用于计算定功率下的中子通量密度)
裂变截面 fission (用于计算定功率下的中子通量密度);
*/

/* 30个有裂变产物场的核素的裂变平均能量，用于有效裂变份额的计算确定	*/
class NuclLibrary 
{
public:
	int nuclide_list_[1693]= {
		10010, 10020, 10030, 10040, 20030, 20040, 20050, 20060,20080, 30060, 30070, 30080,30090, 40070,
		40080, 40090, 40100, 40110,40120, 50100, 50110, 50120, 60120, 60130, 60140,
		60150, 70130, 70140, 70150, 70160, 80160, 80170, 80180, 80190, 90190,
		90200, 100200, 100210, 100220, 100230, 110220, 110230, 110240, 110241, 110250,
		120240, 120250, 120260, 120270, 120280, 130260, 130270, 130280, 130290, 130300,
		140280, 140290, 140300, 140310, 140320, 150310, 150320, 150330, 150340, 160320,
		160330, 160340, 160350, 160360, 160370, 170350, 170360, 170370, 170380, 170381,
		180360, 180370, 180380, 180390, 180400, 180410, 180420, 190390, 190400, 190410,
		190420, 190430, 190440, 200400, 200410, 200420, 200430, 200440, 200450, 200460,
		200470, 200480, 200490, 210440, 210441, 210450, 210451, 210460, 210461, 210470,
		210480, 210490, 210500, 220440, 220450, 220460, 220470, 220480, 220490, 220500,
		220510, 230480, 230490, 230500, 230510, 230520, 230530, 230540, 240480, 240490,
		240500, 240510, 240520, 240530, 240540, 240550, 240660, 240670, 250520, 250530,
		250540, 250550, 250560, 250570, 250580, 250660, 250670, 250680, 250690, 260540,
		260550, 260560, 260570, 260580, 260590, 260600, 260650, 260660, 260670, 260680,
		260690, 260700, 260710, 260720, 270550, 270560, 270570, 270580, 270581, 270590,
		270600, 270601, 270610, 270620, 270650, 270660, 270670, 270680, 270690, 270700,
		270710, 270720, 270730, 270740, 270750, 280560, 280570, 280580, 280590, 280600,
		280610, 280620, 280630, 280640, 280650, 280660, 280670, 280680, 280690, 280700,
		280710, 280720, 280730, 280740, 280750, 280760, 280770, 280780, 290620, 290630,
		290640, 290650, 290660, 290670, 290680, 290681, 290690, 290700, 290701, 290710,
		290720, 290730, 290740, 290750, 290760, 290770, 290780, 290790, 290800, 290810, 300630,
		300640, 300650, 300660, 300670, 300680, 300690, 300691, 300700, 300710, 300711,
		300720, 300730, 300740, 300750, 300760, 300770, 300780, 300790, 300800, 300810,
		300820, 300830, 310660, 310670, 310680, 310690, 310700, 310710, 310720, 310721,
		310730, 310740, 310741, 310750, 310760, 310770, 310780, 310790, 310800, 310810,
		310820, 310830, 310840, 310850, 310860, 320660, 320670, 320680, 320690, 320700,
		320710, 320711, 320720, 320730, 320731, 320740, 320750, 320751, 320760, 320770,
		320771, 320780, 320790, 320791, 320800, 320810, 320811, 320820, 320830, 320840,
		320850, 320860, 320870, 320880, 320890, 330690, 330710, 330720, 330730, 330740,
		330750, 330751, 330760, 330770, 330780, 330790, 330800, 330810, 330820, 330821,
		330830, 330840, 330841, 330850, 330860, 330870, 330880, 330890, 330900, 330910, 330920,
		340720, 340730, 340731, 340740, 340750, 340760, 340770, 340771, 340780, 340790,
		340791, 340800, 340810, 340811, 340820, 340830, 340831, 340840, 340850, 340851, 340860,
		340870, 340880, 340890, 340900, 340910, 340920, 340930, 340940, 350750, 350760,
		350770, 350771, 350780, 350790, 350791, 350800, 350801, 350810, 350820, 350821,
		350830, 350840, 350841, 350850, 350860, 350861, 350870, 350880, 350890, 350900, 350910,
		350920, 350930, 350940, 350950, 350960, 350970, 360760, 360770, 360780, 360790,
		360791, 360800, 360810, 360811, 360820, 360830, 360831, 360840, 360850, 360851,
		360860, 360870, 360880, 360890, 360900, 360910, 360920, 360930, 360940, 360950,
		360960, 360970, 360980, 360990, 361000, 370790, 370810, 370820, 370830, 370840,
		370850, 370860, 370861, 370870, 370880, 370890, 370900, 370901, 370910, 370920,
		370930, 370940, 370950, 370960, 370970, 370980, 370990, 371000, 371010, 371020,
		380820, 380830, 380840, 380850, 380851, 380860, 380870, 380871, 380880, 380890,
		380900, 380910, 380920, 380930, 380940, 380950, 380960, 380970, 380980, 380990,
		381000, 381010, 381020, 381030, 381040, 381050, 390850, 390860, 390870, 390871,
		390880, 390890, 390891, 390900, 390901, 390910, 390911, 390920, 390930, 390931,
		390940, 390950, 390960, 390961, 390970, 390971, 390980, 390981, 390990, 391000,
		391010, 391020, 391030, 391040, 391050, 391060, 391070, 391080, 400860, 400870,
		400880, 400890, 400891, 400900, 400901, 400910, 400920, 400930, 400940, 400950,
		400960, 400970, 400980, 400990, 401000, 401010, 401020, 401030, 401040, 401050,
		401060, 401070, 401080, 401090, 401100, 410890, 410900, 410901, 410910, 410911,
		410920, 410921, 410930, 410931, 410940, 410941, 410950, 410951, 410960, 410970,
		410971, 410980, 410981, 410990, 410991, 411000, 411001, 411010, 411020, 411021,
		411030, 411040, 411041, 411050, 411060, 411070, 411080, 411090, 411100, 411110,
		411120, 411130, 420900, 420910, 420920, 420930, 420931, 420940, 420950, 420960,
		420970, 420980, 420990, 421000, 421010, 421020, 421030, 421040, 421050, 421060,
		421070, 421080, 421090, 421100, 421110, 421120, 421130, 421140, 421150, 430930,
		430950, 430951, 430960, 430970, 430971, 430980, 430990, 430991, 431000, 431010,
		431020, 431021, 431030, 431040, 431050, 431060, 431070, 431080, 431090, 431100,
		431110, 431120, 431130, 431140, 431150, 431160, 431170, 431180, 440950, 440960,
		440970, 440980, 440990, 441000, 441010, 441020, 441030, 441040, 441050, 441060,
		441070, 441080, 441090, 441091,441100, 441110, 441120, 441130, 441140, 441150, 441160,
		441170, 441180, 441190, 441200, 450990, 450991, 451000, 451010, 451011, 451020,
		451021, 451030, 451031, 451040, 451041, 451050, 451051, 451060, 451061, 451070,
		451080, 451081, 451090, 451091, 451100, 451101, 451110, 451120, 451130, 451140, 451150,
		451160, 451170, 451180, 451190, 451200, 451210, 451220, 451230, 460990, 461000, 461010,
		461020, 461030, 461040, 461050, 461060, 461070, 461071, 461080, 461090, 461091,
		461100, 461110, 461111, 461120, 461130, 461140, 461150, 461160, 461170, 461180,
		461190, 461200, 461210, 461220, 461230, 461240, 461250, 461260, 471030, 471050, 471051, 471060,
		471061, 471070, 471071, 471080, 471081, 471090, 471091, 471100, 471101, 471110,
		471111, 471120, 471130, 471131, 471140, 471150, 471151, 471160, 471161, 471170,
		471171, 471180, 471181, 471190, 471200, 471201, 471210, 471220, 471221, 471230,
		471240, 471250, 471260, 471270, 471280, 471290, 471300, 481050, 481060, 481070,
		481080, 481090, 481100, 481110, 481111, 481120, 481130, 481131, 481140, 481150,
		481151, 481160, 481170, 481171, 481180, 481190, 481191, 481200, 481210, 481211,
		481220, 481230, 481231, 481240, 481250, 481260, 481270, 481280, 481290, 481300,
		481310, 481320, 491070, 491090, 491110, 491111, 491120, 491121, 491130, 491131,
		491140, 491141, 491150, 491151, 491160, 491161, 491170, 491171, 491180, 491181,
		491190, 491191, 491200, 491201, 491210, 491211, 491220, 491221, 491230, 491231,
		491240, 491241, 491250, 491251, 491260, 491261, 491270, 491271, 491280, 491281,
		491290, 491291, 491300, 491301, 491310, 491311, 491320, 491330, 491340, 491350,
		501110, 501120, 501130, 501131, 501140, 501150, 501160, 501170, 501171, 501180,
		501190, 501191, 501200, 501210, 501211, 501220, 501230, 501231, 501240, 501250,
		501251, 501260, 501270, 501271, 501280, 501281, 501290, 501291, 501300, 501301,
		501310, 501311, 501320, 501330, 501340, 501350, 501360, 501370, 511130, 511150,
		511170, 511180, 511181, 511190, 511200, 511201, 511210, 511220, 511221, 511230,
		511240, 511241, 511250, 511260, 511261, 511270, 511280, 511281, 511290, 511291,
		511300, 511301, 511310, 511320, 511321, 511330, 511340, 511341, 511350, 511360,
		511370, 511380, 511390, 521150, 521170, 521180, 521190, 521191, 521200, 521210,
		521211, 521220, 521230, 521231, 521240, 521250, 521251, 521260, 521270, 521271,
		521280, 521290, 521291, 521300, 521310, 521311, 521320, 521330, 521331, 521340,
		521350, 521360, 521370, 521380, 521390, 521400, 521410, 521420, 531210, 531220,
		531230, 531240, 531250, 531260, 531270, 531280, 531290, 531300, 531301, 531310,
		531320, 531321, 531330, 531331, 531340, 531341, 531350, 531360, 531361, 531370,
		531380, 531390, 531400, 531410, 531420, 531430, 531440, 531450, 541220, 541230, 541240,
		541250, 541251, 541260, 541270, 541271, 541280, 541290, 541291, 541300, 541310,
		541311, 541320, 541330, 541331, 541340, 541341, 541350, 541351, 541360, 541370,
		541380, 541390, 541400, 541410, 541420, 541430, 541431, 541440, 541450, 541460, 541470,
		551270, 551280, 551290, 551300, 551310, 551320, 551330, 551340, 551341, 551350,
		551351, 551360, 551361, 551370, 551380, 551381, 551390, 551400, 551410, 551420,
		551430, 551440, 551450, 551460, 551470, 551480, 551490, 551500, 551510, 561280,
		561290, 561300, 561310, 561311, 561320, 561330, 561331, 561340, 561350, 561351,
		561360, 561361, 561370, 561371, 561380, 561390, 561400, 561410, 561420, 561430,
		561440, 561450, 561460, 561470, 561480, 561490, 561500, 561510, 561520, 561530,
		571330, 571340, 571350, 571360, 571370, 571380, 571390, 571400, 571410, 571420,
		571430, 571440, 571450, 571460, 571461, 571470, 571480, 571490, 571500, 571510,
		571520, 571530, 571540, 571550, 581340, 581350, 581360, 581370, 581371, 581380,
		581390, 581391, 581400, 581410, 581420, 581430, 581440, 581450, 581460, 581470,
		581480, 581490, 581500, 581510, 581520, 581530, 581540, 581550, 581560, 581570,
		591390, 591400, 591410, 591420, 591421, 591430, 591440, 591441, 591450, 591460,
		591470, 591480, 591481, 591490, 591500, 591510, 591520, 591530, 591540, 591550,
		591560, 591570, 591580, 591590, 601400, 601410, 601411, 601420, 601430, 601440,
		601450, 601460, 601470, 601480, 601490, 601500, 601510, 601520, 601530, 601540,
		601550, 601560, 601570, 601580, 601590, 601600, 601610, 611410, 611430, 611440,
		611450, 611460, 611470, 611480, 611481, 611490, 611500, 611510, 611520, 611521,
		611530, 611540, 611541, 611550, 611560, 611570, 611580, 611590, 611600, 611610,
		611620, 611630, 621430, 621431, 621440, 621450, 621460, 621470, 621480, 621490,
		621500, 621510, 621520, 621530, 621540, 621550, 621560, 621570, 621580, 621590,
		621600, 621610, 621620, 621630, 621640, 621650, 631450, 631460, 631470, 631480,
		631490, 631500, 631501, 631510, 631520, 631521, 631530, 631540, 631541, 631550,
		631560, 631570, 631580, 631590, 631600, 631610, 631620, 631630, 631640, 631650,
		631660, 631670, 641460, 641470, 641480, 641490, 641500, 641510, 641520, 641530,
		641540, 641550, 641551, 641560, 641570, 641580, 641590, 641600, 641610, 641620,
		641630, 641640, 641650, 641660, 641670, 641680, 641690, 651510, 651520, 651530,
		651540, 651541, 651550, 651560, 651561, 651570, 651580, 651581, 651590, 651600,
		651610, 651620, 651621, 651630, 651631, 651640, 651650, 651660, 651670, 651680, 651690, 651700,
		651710, 661540, 661550, 661560, 661570, 661580, 661590, 661600, 661610, 661620,
		661630, 661640, 661650, 661651, 661660, 661670, 661680, 661690, 661700, 661710,
		661720, 671590, 671591, 671600, 671601, 671610, 671611, 671620, 671621, 671630,
		671631, 671640, 671641, 671650, 671660, 671661, 671670, 671680, 671690, 671700,
		671701, 671710, 671720, 681600, 681610, 681620, 681630, 681640, 681650, 681660,
		681670, 681671, 681680, 681690, 681700, 681710, 681720, 691650, 691660, 691670,
		691680, 691690, 691700, 691701, 691710, 691720, 691730, 701660, 701670, 701680, 701690,
		701691, 701700, 701710, 701720, 701730, 701740, 701750, 701751, 701760, 701770,
		711690, 711691, 711700, 711710, 711711, 711720, 711721, 711730, 711740, 711741,
		711750, 711760, 711761, 711770, 711771, 721700, 721710, 721720, 721730, 721740,
		721750, 721760, 721770, 721771, 721780, 721781, 721790, 721791, 721800, 721801,
		721810, 721820, 731770, 731780, 731790, 731800, 731801, 731810, 731820, 731821,
		731830, 741780, 741800, 741810, 741820, 741830, 741831, 741840, 741850, 741851,
		741860, 741870, 741880, 741890, 751810, 751820, 751821, 751830, 751840, 751841,
		751850, 751860, 751861, 751870, 751880, 751881, 751890, 761820, 761830, 761840,
		761850, 761860, 761870, 761880, 761890, 761891, 761900, 761901, 761910, 761911,
		761920, 761930, 761940, 771850, 771860, 771880, 771890, 771891, 771900, 771910,
		771911, 771920, 771921, 771930, 771931, 771940, 771941, 771960, 771961, 781880,
		781890, 781900, 781910, 781920, 781930, 781931, 781940, 781950, 781951, 781960,
		781970, 781971, 781980, 781990, 781991, 782000, 791930, 791940, 791950, 791951,
		791960, 791970, 791971, 791980, 791981, 791990, 792000, 792001, 801930, 801931,
		801940, 801950, 801951, 801960, 801970, 801971, 801980, 801990, 801991, 802000,
		802010, 802020, 802030, 802040, 802050, 802060, 812000, 812010, 812020, 812030,
		812040, 812050, 812060, 812070, 812080, 812090, 812100, 822000, 822020, 822030,
		822040, 822050, 822051, 822060, 822070, 822071, 822080, 822090, 822100, 822110,
		822120, 822140, 832050, 832060, 832070, 832080, 832090, 832100, 832101, 832110,
		832120, 832121, 832130, 832140, 842060, 842070, 842080, 842090, 842100, 842110,
		842111, 842120, 842130, 842140, 842150, 842160, 842180, 852160, 852170, 852180,
		862160, 862170, 862180, 862190, 862200, 862220, 872200, 872210, 872220, 872230,
		882200, 882220, 882230, 882240, 882250, 882260, 882270, 882280, 892240, 892250,
		892260, 892270, 892280, 902260, 902270, 902280, 902290, 902300, 902310, 902320,
		902330, 902340, 912280, 912290, 912300, 912310, 912320, 912330, 912340, 912341,
		912350, 922300, 922310, 922320, 922330, 922340, 922350, 922351, 922360, 922370,
		922380, 922390, 922400, 922410, 932340, 932350, 932360, 932361, 932370, 932380,
		932390, 932400, 932401, 932410, 942360, 942370, 942371, 942380, 942390, 942400,
		942410, 942420, 942430, 942440, 942450, 942460, 942470, 952390, 952400, 952410,
		952420, 952421, 952430, 952440, 952441, 952450, 952460, 952461, 952470, 962400,
		962410, 962420, 962430, 962440, 962450, 962460, 962470, 962480, 962490, 962500,
		962510, 972450, 972460, 972470, 972480, 972481, 972490, 972500, 972510, 982460,
		982480, 982490, 982500, 982510, 982520, 982530, 982540, 982550, 992510, 992520,
		992530, 992540, 992541, 992550
	};
	int nuclide_number_  = 1693;
	string element_name_list_[118] = {
		"H",  "He", "Li",  "Be",  "B",   "C",   "N",   "O",  "F",  "Ne",
		"Na", "Mg", "Al",  "Si",  "P",   "S",   "Cl",  "Ar", "K",  "Ca",
		"Sc", "Ti", "V",   "Cr",  "Mn",  "Fe",  "Co",  "Ni", "Cu", "Zn",
		"Ga", "Ge", "As",  "Se",  "Br",  "Kr",  "Rb",  "Sr", "Y",  "Zr",
		"Nb", "Mo", "Tc",  "Ru",  "Rh",  "Pd",  "Ag",  "Cd", "In", "Sn",
		"Sb", "Te", "I",   "Xe",  "Cs",  "Ba",  "La",  "Ce", "Pr", "Nd",
		"Pm", "Sm", "Eu",  "Gd",  "Tb",  "Dy",  "Ho",  "Er", "Tm", "Yb",
		"Lu", "Hf", "Ta",  "W",   "Re",  "Os",  "Ir",  "Pt", "Au", "Hg",
		"Tl", "Pb", "Bi",  "Po",  "At",  "Rn",  "Fr",  "Ra", "Ac", "Th",
		"Pa", "U",  "Np",  "Pu",  "Am",  "Cm",  "Bk",  "Cf", "Es", "Fm",
		"Md", "No", "Lr",  "Rf",  "Db",  "Sg",  "Bh",  "Hs", "Mt", "Ds",
		"Rg", "Cn", "Uut", "Uuq", "Uup", "Uuh", "Uus", "Uuo" };

	vector<vector< double > > nuclide_library_vector_; // 存储核素的全部信息，包括各种衰变信息和截面信息；


	////////////////////////      裂变份额部分的数据集合 /////////////////////////////////////////////
	vector<int> fissionable_nuclide_id_vector_; // 拥有给定裂变场的可裂变核素
	vector<vector<int> > fission_products_id_vector_;	// 裂变产物ID
	vector<vector<double> > effective_fission_yields_vector_;
	////////////////////////////////////////////////////////////////////////////////////////////////////

	vector<int> nuclide_index_vector_;

public:
	double specified_power_ = 0;						// 绝对功率，单位 MW
	double flux_ = 0;								// 中子通量密度，单位  neutrons/(cm2*s).
	double heavy_metal_mass_ = 0;								// 重金属质量，用来计算燃耗深度

public:
 
	NuclLibrary();

	int GetNuclIndex(int NuclID)
	{
		if (NuclID > 992550)
		{
			return -1;
		}

		int conucl = nuclide_index_vector_[NuclID];

		if (conucl == 0 && NuclID != 10010)
		{
			stringstream ss;
			string id;
			ss << NuclID;
			ss >> id;
			id = "Position: int NuclLibrary::GetNuclIndex; \n Warning: the unknown nuclide id " + id + ".";
			InfoMessage::ErrorMessage(id, 0);
			return -1;
		}
		return conucl; // 这里是一个vector数组，用来存储不同核素的Index
	}


	vector<int> GetEleIndex(int Z);

	void CalculateFlux(int mode); // 在定功率或者定功率密度下，计算中子通量密度

	double CalculatePowerKernel();
};

#endif